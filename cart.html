<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoLog - Shopping Cart</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/cart.css">
</head>
<body>
  <div class="d-flex flex-column min-vh-100">
      <!-- Header -->
      <div id="header-placeholder"></div>

      <!-- Main content -->
      <main class="flex-grow-1 container mt-4">
          <h2 class="mb-4">Your Cart</h2>
          <div id="cart-container"></div>
      </main>

      <!-- Footer -->
      <div id="footer-placeholder"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/script.js"></script>

  <script>
    // Load header and footer
    fetch('header.html').then(r => r.text()).then(data => document.getElementById('header-placeholder').innerHTML = data);
    fetch('footer.html').then(r => r.text()).then(data => document.getElementById('footer-placeholder').innerHTML = data);

    document.addEventListener("DOMContentLoaded", loadCart);

    function loadCart() {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        let container = document.getElementById("cart-container");

        if (cart.length === 0) {
            container.innerHTML = "<p class='text-center text-muted'>Your cart is empty</p>";
            return;
        }

        const prices = {
            "Polish": 1500,
            "Denso Spark Plug": 3000,
            "DashCam": 2500,
            "Corolla Rear Light": 30000,
            "Civic Rebirth Headlight": 40000,
            "GWM Haval H6 Side Mirror": 45000,
            "HKS Exhaust": 10000,
            "Air Freshner": 750,
            "Continental 205/45/18": 28000,
            "Android Screen 10-inch": 17000,
            "Air Filter for Civic": 1500,
            "Sun Shades for Corolla": 2250,
            "Car Wax": 1500,
            "Steering Covers": 2250,
            "Civic Reborn Sidemirrors": 5000,
            "Corolla Steering": 25000
        };

        let html = `
            <div class="table-responsive">
                <table class="table table-bordered align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Price (PKR)</th>
                            <th>Total (PKR)</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
        `;

        let grandTotal = 0;
        cart.forEach((item, index) => {
            let price = prices[item.name] || 0;
            let total = price * item.quantity;
            grandTotal += total;

            html += `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.quantity}</td>
                    <td>${price}</td>
                    <td>${total}</td>
                    <td><button class="btn btn-danger btn-sm" onclick="removeItem(${index})">Remove</button></td>
                </tr>
            `;
        });

        // Save grand total for checkout
        localStorage.setItem("cartGrandTotal", grandTotal);

        html += `
                    </tbody>
                </table>
            </div>
            <h3 class="text-end">Grand Total: ${grandTotal} PKR</h3>
            <div class="d-flex justify-content-center mt-4">
                <a href="payment.html" class="btn btn-success btn-lg ${grandTotal === 0 ? 'disabled' : ''}" id="checkout-btn">Proceed to Checkout</a>
            </div>
        `;

        container.innerHTML = html;
    }

    function removeItem(index) {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        loadCart(); // refresh display
    }
  </script>
</body>
</html>


